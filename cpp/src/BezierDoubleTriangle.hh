#ifndef CPP_BEZIER_DOUBLE_TRIANGLE_HH
#define CPP_BEZIER_DOUBLE_TRIANGLE_HH

#include "utils.hh"

#include <Eigen/Core>

namespace pev
{

template<typename T, typename C=double>
class BezierDoubleTriangle
{
public:
    using Self = BezierDoubleTriangle;
    using Coeffs = Eigen::Matrix<T, 18, 1>;
    using Coords = Eigen::Matrix<C, 6, 1>;

    enum Indices: int
    {
        i100200 = 0,
        i010200,
        i001200,
        i100020,
        i010020,
        i001020,
        i100002,
        i010002,
        i001002,
        i100110,
        i010110,
        i001110,
        i100011,
        i010011,
        i001011,
        i100101,
        i010101,
        i001101
    };

    BezierDoubleTriangle()
    {}

    explicit BezierDoubleTriangle(const Coeffs& coefficients):
            _coeffs(coefficients)
    {}

    T operator()(const Coords& pos) const
    {
        return makeBasis(pos).dot(_coeffs);
    }

    C& operator[](int i)
    {
        return _coeffs[i];
    }

    const C& operator[](int i) const
    {
        return _coeffs[i];
    }

    Coeffs& coefficients()
    {
        return _coeffs;
    }

    const Coeffs& coefficients() const
    {
        return _coeffs;
    }

    // @todo: Implement possibility to split only in one space
    std::array<Self, 16> split() const
    {
        return {Self{m00()*_coeffs}, Self{m01()*_coeffs}, Self{m02()*_coeffs}, Self{m03()*_coeffs},
                Self{m10()*_coeffs}, Self{m11()*_coeffs}, Self{m12()*_coeffs}, Self{m13()*_coeffs},
                Self{m20()*_coeffs}, Self{m21()*_coeffs}, Self{m22()*_coeffs}, Self{m23()*_coeffs},
                Self{m30()*_coeffs}, Self{m31()*_coeffs}, Self{m32()*_coeffs}, Self{m33()*_coeffs}};
    }


private:

    using Matrix18 = Eigen::Matrix<T, 18, 18>;
    using Basis = Eigen::Matrix<C, 18, 1>;

    // Coefficients of the Bezier Triangle
    Coeffs _coeffs;

    static Basis makeBasis(const Coords& pos)
    {
        return (Basis{} <<  1*pos[0]*pos[3]*pos[3],
                            1*pos[1]*pos[3]*pos[3],
                            1*pos[2]*pos[3]*pos[3],
                            1*pos[0]*pos[4]*pos[4],
                            1*pos[1]*pos[4]*pos[4],
                            1*pos[2]*pos[4]*pos[4],
                            1*pos[0]*pos[5]*pos[5],
                            1*pos[1]*pos[5]*pos[5],
                            1*pos[2]*pos[5]*pos[5],
                            2*pos[0]*pos[3]*pos[4],
                            2*pos[1]*pos[3]*pos[4],
                            2*pos[2]*pos[3]*pos[4],
                            2*pos[0]*pos[4]*pos[5],
                            2*pos[1]*pos[4]*pos[5],
                            2*pos[2]*pos[4]*pos[5],
                            2*pos[0]*pos[3]*pos[5],
                            2*pos[1]*pos[3]*pos[5],
                            2*pos[2]*pos[3]*pos[5]).finished();
    }

    // Splitting operator matrices
    static Matrix18 m00()
    {
        static Matrix18 result = (Matrix18{} <<
                   1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,
                1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4

        ).finished();
        return result;
    };

    static Matrix18 m01()
    {
        static Matrix18 result = (Matrix18{} <<
                1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8
        ).finished();
        return result;
    };

    static Matrix18 m02()
    {
        static Matrix18 result = (Matrix18{} <<
                1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                  0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4
        ).finished();
        return result;
    };

    static Matrix18 m03()
    {
        static Matrix18 result = (Matrix18{} <<
                  0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8
        ).finished();
        return result;
    };

    static Matrix18 m10()
    {
        static Matrix18 result = (Matrix18{} <<
                1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,
                  0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4
        ).finished();
        return result;
    };

    static Matrix18 m11()
    {
        static Matrix18 result = (Matrix18{} <<
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8
        ).finished();
        return result;
    };

    static Matrix18 m12()
    {
        static Matrix18 result = (Matrix18{} <<
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4
        ).finished();
        return result;
    };

    static Matrix18 m13()
    {
        static Matrix18 result = (Matrix18{} <<
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8
        ).finished();
        return result;
    };

    static Matrix18 m20()
    {
        static Matrix18 result = (Matrix18{} <<
                1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                  0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,
                1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,
                1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                  0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                  0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2
        ).finished();
        return result;
    };

    static Matrix18 m21()
    {
        static Matrix18 result = (Matrix18{} <<
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4
        ).finished();
        return result;
    };

    static Matrix18 m22()
    {
        static Matrix18 result = (Matrix18{} <<
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                  0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2
        ).finished();
        return result;
    };

    static Matrix18 m23()
    {
        static Matrix18 result = (Matrix18{} <<
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                  0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0., 1./4,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,
                1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4,
                  0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0.,   0.,   0., 1./4,   0.,   0.,   0.,   0.,   0., 1./4,   0.,   0., 1./4,   0.,   0., 1./4
        ).finished();
        return result;
    };

    static Matrix18 m30()
    {
        static Matrix18 result = (Matrix18{} <<
                  0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.
        ).finished();
        return result;
    };

    static Matrix18 m31()
    {
        static Matrix18 result = (Matrix18{} <<
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.
        ).finished();
        return result;
    };

    static Matrix18 m32()
    {
        static Matrix18 result = (Matrix18{} <<
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2,   0., 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./2, 1./2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                  0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.
        ).finished();
        return result;
    };

    static Matrix18 m33()
    {
        static Matrix18 result = (Matrix18{} <<
                  0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,
                  0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,
                1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./4,   0., 1./4,
                1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,
                  0., 1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8,   0., 1./8, 1./8,   0., 1./8,   0.,   0.,   0., 1./4,   0., 1./4,   0.,   0.,   0.,   0.,   0.,   0.,
                1./8, 1./8,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./4, 1./4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
                  0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0., 1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                1./8,   0., 1./8,   0.,   0.,   0.,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                1./8, 1./8,   0.,   0.,   0.,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.,
                  0.,   0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,
                  0.,   0.,   0., 1./8,   0., 1./8,   0.,   0.,   0., 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8,
                  0.,   0.,   0., 1./8, 1./8,   0.,   0.,   0.,   0., 1./8, 1./8,   0., 1./8, 1./8,   0., 1./8, 1./8,   0.
        ).finished();
        return result;
    };

};

} // namespace pev

#endif
